<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì§€ì˜¥ì˜ ê°€ìœ„ë°”ìœ„ë³´ PvP</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; text-align: center; }
    .container { margin-top: 50px; }
    .status { margin: 20px 0; }
    .btn-group button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
  </style>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>ğŸ”¥ ì§€ì˜¥ì˜ ê°€ìœ„ë°”ìœ„ë³´ PvP ğŸ”¥</h1>
    <div id="status" class="status">ìƒëŒ€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</div>

    <div id="hp-status" class="status" style="display: none;">
      ë‚´ HP: <span id="my-hp">100</span> / ìƒëŒ€ HP: <span id="enemy-hp">100</span>
    </div>

    <div id="choices" class="btn-group" style="display: none;">
      <button onclick="sendMove('ê°€ìœ„')">ê°€ìœ„ âœŒï¸</button>
      <button onclick="sendMove('ë°”ìœ„')">ë°”ìœ„ âœŠ</button>
      <button onclick="sendMove('ë³´')">ë³´ ğŸ–ï¸</button>
    </div>

    <div id="log" class="status"></div>
  </div>

  <script>
    const socket = io("https://moondo-production.up.railway.app");

    let myHP = 100;
    let enemyHP = 100;
    let selected = false;

    function sendMove(move) {
      if (selected) return;
      selected = true;
      document.getElementById('log').innerText = `ë‹¹ì‹ ì˜ ì„ íƒ: ${move}`;
      socket.emit('player_move', move);
    }

    socket.on('wait', () => {
      document.getElementById('status').innerText = 'ìƒëŒ€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...';
    });

    socket.on('start', () => {
      document.getElementById('status').innerText = 'ê²Œì„ ì‹œì‘! ì„ íƒì§€ë¥¼ ê³ ë¥´ì„¸ìš”.';
      document.getElementById('choices').style.display = 'block';
      document.getElementById('hp-status').style.display = 'block';
    });

    socket.on('round_result', ({ myHP: mh, enemyHP: eh, log }) => {
      myHP = mh;
      enemyHP = eh;
      document.getElementById('my-hp').innerText = myHP;
      document.getElementById('enemy-hp').innerText = enemyHP;
      document.getElementById('log').innerText = log;
      selected = false;

      if (myHP <= 0 || enemyHP <= 0) {
        document.getElementById('status').innerText = myHP <= 0 ? 'íŒ¨ë°°í–ˆìŠµë‹ˆë‹¤ ğŸ˜µ' : 'ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤ ğŸ‰';
        document.getElementById('choices').style.display = 'none';
      }
    });
  </script>
</body>
</html>
